{% extends 'home.html' %}

{% block contenido %}
{% load static %}

<link rel="stylesheet" href="{% static 'bootstrap/css/estrategias.css' %}">

<div class="main p-3">
    <div class="text-center">
        <div class="container">
           
                <h1 class="h1 mb-4">Estrategias</h1>
               
                
                <div class="container mt-1 filtros" >
                    <div class="row align-items-center">
                        <div class="col-md-3 mb-2"> <!-- Fecha Inicio -->
                            <div class="form-group row">
                                <label for="filtroFechaInicio" class="col-sm-5 col-form-label col-form-label-sm">Fecha Inicio:</label>
                                <div class="col-sm-7">
                                    <input type="date" class="form-control form-control-sm" id="filtroFechaInicio">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2"> <!-- Fecha Fin -->
                            <div class="form-group row">
                                <label for="filtroFechaFin" class="col-sm-5 col-form-label col-form-label-sm">Fecha Fin:</label>
                                <div class="col-sm-7">
                                    <input type="date" class="form-control form-control-sm" id="filtroFechaFin">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2"> <!-- Municipio -->
                            <div class="form-group row">
                                <label for="filtroSeleccion" class="col-sm-5 col-form-label col-form-label-sm">Estrategia:</label>
                                <div class="col-sm-7">
                                  
                                    <select name="estrategia" id="estrategia" onchange="aplicarFiltrosEstrategias()">
                                        <option value="" disabled {% if not select_estrategia %}selected{% endif %}>Seleccione una estrategia</option>
                                        {% for estrategia in estrategias %}
                                            <option value="{{ estrategia.est_id }}" {% if estrategia.est_id|stringformat:"s" == select_estrategia %}selected{% endif %}>{{ estrategia.est_nombre }}</option>
                                        {% endfor %}
                                    </select>
                                    
                                  
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2 top-adjust "> <!-- Espacio para metas visuales -->
                            <div class="meta-container">
                                <div class="meta">
                                    60-100%
                                    <div class="cuadro verde"></div>
                                </div>
                                <div class="meta">
                                    50-59%
                                    <div class="cuadro amarilla"></div>
                                </div>
                                <div class="meta">
                                    30-49%
                                    <div class="cuadro naranja"></div>
                                </div>
                                <div class="meta">
                                    0-29%
                                    <div class="cuadro roja"></div>
                                </div>
                            </div> 
                        </div>
                    </div>
                </div>
            
       
    </div>
       
    <div class="container text-center ">
        <div class="row row-cols-3 row-cols-lg-3  ">
            <div class="col p-1">
               
                    
                        <canvas id="auxiliar" width="300" height="300"></canvas>
               
           
            </div>
            <div class="col p-1">
               
                   
                        <canvas id="tecnico" width="300" height="300"></canvas>
                  
                </div>
          
            <div class="col p-1 ">
               
                    
                        <canvas id="tecnologo" width="300" height="300"></canvas>
                   
            
            </div>
       
            <div class="col p-1 ">
              
                  
                        <canvas id="profundizacion_tecnica" width="300" height="300"></canvas>
              
         
            </div>
            <div class="col p-1">
           
              
                        <canvas id="evento" width="300" height="300"></canvas>
             
               
            </div>
            <div class="col p-1">
              
                   
                        <canvas id="operario" width="300" height="300"></canvas>
                  
           
            </div>
     
       
            <div class="col p-1">
               
                   
                        <canvas id="curso_especial" width="300" height="300"></canvas>
                
         
            </div>
            <div class="col p-1">
                <canvas id="bilinguismo" width="300" height="300"></canvas>
            </div>
            <div class="col p-1">
                <canvas id="sin_bilinguismo" width="300" height="300"></canvas>
            </div>
        </div>
    </div>
    <div class="container">
        <div style="max-height: 400px; overflow-x: auto; overflow-y: auto;">
            <table class="table table-striped table-hover data-table" id="resultados_tabla">
                <thead class="table-dark">
                    <tr>
                        <th scope="col" style="min-width: 200px;" class="fixed-header"></th>
                      
                        <th scope="col" style="min-width: 200px;" class="fixed-header">Auxiliar</th>
                        <th scope="col" style="min-width: 200px;" class="fixed-header">Técnico</th>
                        <th scope="col" style="min-width: 100px;" class="fixed-header">Tecnólogo</th>
                        <th scope="col" style="min-width: 100px;" class="fixed-header">Profundización Técnica</th>
                        <th scope="col" style="min-width: 100px;" class="fixed-header">Evento</th>
                        <th scope="col" style="min-width: 150px;" class="fixed-header">Operario</th>
                        <th scope="col" style="min-width: 150px;" class="fixed-header">Curso Especial</th>
                        <th scope="col" style="min-width: 150px;" class="fixed-header">Bilingüismo</th>
                        <th scope="col" style="min-width: 150px;" class="fixed-header">Sin Bilingüismo</th>
             

                     
                        

                    </tr>
                </thead>
              
                <tbody id="resultados">
                    <tr>
                        <td class="fixed-column">Modalidad presencial</td>
                    
                         {%for data_presencial in data_tabla_presencial%}
                        <td>{{data_presencial}}</td>
                       
                        {%endfor%}
                    </tr>
                    <tr>
                        <td class="fixed-column">Modalidad virtual</td>
                 
                        {%for data_virtual in data_tabla_virtual%}
                        <td>{{data_virtual}}</td>
                       
                        {%endfor%}
                    </tr>
                    <tr>
                        <td class="fixed-column">Meta Presencial</td>
                        {%for metas_presencial in metas_presencial%}
                        <td>{{metas_presencial.met_formacion_curso_especial}}</td>
                        <td>{{metas_presencial.met_formacion_tecnologo}}</td>
                        <td>{{metas_presencial.met_formacion_tecnico}}</td>
                        <td>{{metas_presencial.met_formacion_auxiliar}}</td>
                        <td>{{metas_presencial.met_formacion_operario}}</td>
                        <td>{{metas_presencial.met_formacion_evento}}</td>
                   
                    
                       
                        {%endfor%}

        
                    </tr>
                    <tr>
                        <td class="fixed-column">Meta Virtual</td>
                        {%for metas_virtual in metas_virtual%}
                        <td>{{metas_virtual.met_formacion_curso_especial}}</td>
                        <td>{{metas_virtual.met_formacion_tecnologo}}</td>
                        <td>{{metas_virtual.met_formacion_tecnico}}</td>
                        <td>{{metas_virtual.met_formacion_auxiliar}}</td>
                        <td>{{metas_virtual.met_formacion_operario}}</td>
                        <td>{{metas_virtual.met_formacion_evento}}</td>
                  
                        {%endfor%}
                    </tr>
                  
                </tbody>
            </table>
            
        </div>
     </div>
    <script id="total_curso_especial_activos" type="application/json">
        {{total_curso_especial_activos|safe}}
    </script>
    <script id="total_tecnologo_activos" type="application/json">
        {{total_tecnologo_activos|safe}}
    </script>
    <script id="total_tecnico_activos" type="application/json">
        {{total_tecnico_activos|safe}}
    </script>
    <script id="total_auxiliar_activos" type="application/json">
        {{total_auxiliar_activos|safe}}
    </script>
    <script id="total_operario_activos" type="application/json">
        {{total_operario_activos|safe}}
    </script>
    <script id="total_evento_activos" type="application/json">
        {{total_evento_activos|safe}}
    </script>
    <script id="total_profundizacion_tecnica_activos" type="application/json">
        {{total_profundizacion_tecnica_activos|safe}}
    </script>
    <script id="total_bilinguismo_activos" type="application/json">
        {{total_bilinguismo_activos|safe}}
    </script>
    <script id="total_sin_bilinguismo_activos" type="application/json">
        {{total_sin_bilinguismo_activos|safe}}
    </script>
    <script>
        let filtro_url = "{% url 'cores:estrategias_index' %}?";

function aplicarFiltrosEstrategias() {
    const estrategia = document.getElementById('estrategia').value;
   
    console.log('jdj',estrategia)
    let url = filtro_url;
    if (estrategia) {
        url += `estrategia=${estrategia}`;
    }
    
    window.location.href = url;
  }
    </script>
    </div>
   
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{% static 'bootstrap/js/auxiliar.js' %}"></script>
    <script src="{% static 'bootstrap/js/curso_especial.js' %}"></script>
    <script src="{% static 'bootstrap/js/evento.js' %}"></script>
    <script src="{% static 'bootstrap/js/operario.js' %}"></script>
    <script src="{% static 'bootstrap/js/profundizacion_tecnica.js' %}"></script>
    <script src="{% static 'bootstrap/js/tecnico.js' %}"></script>
    <script src="{% static 'bootstrap/js/tecnologo.js' %}"></script>
    <script src="{% static 'bootstrap/js/bilinguismo.js' %}"></script>
    <script src="{% static 'bootstrap/js/sin_bilinguismo.js' %}"></script>
    <script src="{% static 'bootstrap/js/estrategias.js' %}"></script>
</div>
</div>
</div>
{% endblock contenido %}
